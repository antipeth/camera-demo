const y={context:void 0,registry:void 0,effects:void 0,done:!1,getContextId(){return B(this.context.count)},getNextContextId(){return B(this.context.count++)}};function B(e){const n=String(e),t=n.length-1;return y.context.id+(t?String.fromCharCode(96+t):"")+n}function N(e){y.context=e}function pe(){return{...y.context,id:y.getNextContextId(),count:0}}const we=!1,ge=(e,n)=>e===n,j=Symbol("solid-proxy"),J=Symbol("solid-track"),U={equals:ge};let ye=oe;const P=1,q=2,ee={owned:null,cleanups:null,context:null,owner:null};var a=null;let W=null,Ae=null,d=null,p=null,C=null,V=0;function Se(e,n){const t=d,s=a,l=e.length===0,r=n===void 0?s:n,o=l?ee:{owned:null,cleanups:null,context:r?r.context:null,owner:r},h=l?e:()=>e(()=>m(()=>T(o)));a=o,d=null;try{return I(h,!0)}finally{d=t,a=s}}function z(e,n){n=n?Object.assign({},U,n):U;const t={value:e,observers:null,observerSlots:null,comparator:n.equals||void 0},s=l=>(typeof l=="function"&&(l=l(t.value)),se(t,l));return[te.bind(t),s]}function xe(e,n,t){const s=re(e,n,!1,P);M(s)}function _(e,n,t){t=t?Object.assign({},U,t):U;const s=re(e,n,!0,0);return s.observers=null,s.observerSlots=null,s.comparator=t.equals||void 0,M(s),te.bind(s)}function Oe(e){return I(e,!1)}function m(e){if(d===null)return e();const n=d;d=null;try{return e()}finally{d=n}}function ve(e){return a===null||(a.cleanups===null?a.cleanups=[e]:a.cleanups.push(e)),e}function G(){return d}function Ce(){return a}function $e(e){C.push.apply(C,e),e.length=0}function ne(e,n){const t=Symbol("context");return{id:t,Provider:ke(t),defaultValue:e}}function Ee(e){let n;return a&&a.context&&(n=a.context[e.id])!==void 0?n:e.defaultValue}function je(e){const n=_(e),t=_(()=>Q(n()));return t.toArray=()=>{const s=t();return Array.isArray(s)?s:s!=null?[s]:[]},t}let Z;function Pe(){return Z||(Z=ne())}function te(){if(this.sources&&this.state)if(this.state===P)M(this);else{const e=p;p=null,I(()=>L(this),!1),p=e}if(d){const e=this.observers?this.observers.length:0;d.sources?(d.sources.push(this),d.sourceSlots.push(e)):(d.sources=[this],d.sourceSlots=[e]),this.observers?(this.observers.push(d),this.observerSlots.push(d.sources.length-1)):(this.observers=[d],this.observerSlots=[d.sources.length-1])}return this.value}function se(e,n,t){let s=e.value;return(!e.comparator||!e.comparator(s,n))&&(e.value=n,e.observers&&e.observers.length&&I(()=>{for(let l=0;l<e.observers.length;l+=1){const r=e.observers[l],o=W&&W.running;o&&W.disposed.has(r),(o?!r.tState:!r.state)&&(r.pure?p.push(r):C.push(r),r.observers&&ue(r)),o||(r.state=P)}if(p.length>1e6)throw p=[],new Error},!1)),n}function M(e){if(!e.fn)return;T(e);const n=V;Fe(e,e.value,n)}function Fe(e,n,t){let s;const l=a,r=d;d=a=e;try{s=e.fn(n)}catch(o){return e.pure&&(e.state=P,e.owned&&e.owned.forEach(T),e.owned=null),e.updatedAt=t+1,ie(o)}finally{d=r,a=l}(!e.updatedAt||e.updatedAt<=t)&&(e.updatedAt!=null&&"observers"in e?se(e,s):e.value=s,e.updatedAt=t)}function re(e,n,t,s=P,l){const r={fn:e,state:s,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:n,owner:a,context:a?a.context:null,pure:t};return a===null||a!==ee&&(a.owned?a.owned.push(r):a.owned=[r]),r}function le(e){if(e.state===0)return;if(e.state===q)return L(e);if(e.suspense&&m(e.suspense.inFallback))return e.suspense.effects.push(e);const n=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<V);)e.state&&n.push(e);for(let t=n.length-1;t>=0;t--)if(e=n[t],e.state===P)M(e);else if(e.state===q){const s=p;p=null,I(()=>L(e,n[0]),!1),p=s}}function I(e,n){if(p)return e();let t=!1;n||(p=[]),C?t=!0:C=[],V++;try{const s=e();return Ne(t),s}catch(s){t||(C=null),p=null,ie(s)}}function Ne(e){if(p&&(oe(p),p=null),e)return;const n=C;C=null,n.length&&I(()=>ye(n),!1)}function oe(e){for(let n=0;n<e.length;n++)le(e[n])}function L(e,n){e.state=0;for(let t=0;t<e.sources.length;t+=1){const s=e.sources[t];if(s.sources){const l=s.state;l===P?s!==n&&(!s.updatedAt||s.updatedAt<V)&&le(s):l===q&&L(s,n)}}}function ue(e){for(let n=0;n<e.observers.length;n+=1){const t=e.observers[n];t.state||(t.state=q,t.pure?p.push(t):C.push(t),t.observers&&ue(t))}}function T(e){let n;if(e.sources)for(;e.sources.length;){const t=e.sources.pop(),s=e.sourceSlots.pop(),l=t.observers;if(l&&l.length){const r=l.pop(),o=t.observerSlots.pop();s<l.length&&(r.sourceSlots[o]=s,l[s]=r,t.observerSlots[s]=o)}}if(e.tOwned){for(n=e.tOwned.length-1;n>=0;n--)T(e.tOwned[n]);delete e.tOwned}if(e.owned){for(n=e.owned.length-1;n>=0;n--)T(e.owned[n]);e.owned=null}if(e.cleanups){for(n=e.cleanups.length-1;n>=0;n--)e.cleanups[n]();e.cleanups=null}e.state=0}function De(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function ie(e,n=a){throw De(e)}function Q(e){if(typeof e=="function"&&!e.length)return Q(e());if(Array.isArray(e)){const n=[];for(let t=0;t<e.length;t++){const s=Q(e[t]);Array.isArray(s)?n.push.apply(n,s):n.push(s)}return n}return e}function ke(e,n){return function(s){let l;return xe(()=>l=m(()=>(a.context={...a.context,[e]:s.value},je(()=>s.children))),void 0),l}}let fe=!1;function Ue(){fe=!0}function Ie(e,n){if(fe&&y.context){const t=y.context;N(pe());const s=m(()=>e(n||{}));return N(t),s}return m(()=>e(n||{}))}const Re=ne();function qe(e){let n=0,t,s,l,r,o;const[h,f]=z(!1),i=Pe(),u={increment:()=>{++n===1&&f(!0)},decrement:()=>{--n===0&&f(!1)},inFallback:h,effects:[],resolved:!1},c=Ce();if(y.context&&y.load){const g=y.getContextId();let x=y.load(g);if(x&&(typeof x!="object"||x.status!=="success"?l=x:y.gather(g)),l&&l!=="$$f"){const[O,S]=z(void 0,{equals:!1});r=O,l.then(()=>{if(y.done)return S();y.gather(g),N(s),S(),N()},$=>{o=$,S()})}}const w=Ee(Re);w&&(t=w.register(u.inFallback));let b;return ve(()=>b&&b()),Ie(i.Provider,{value:u,get children(){return _(()=>{if(o)throw o;if(s=y.context,r)return r(),r=void 0;s&&l==="$$f"&&N();const g=_(()=>e.children);return _(x=>{const O=u.inFallback(),{showContent:S=!0,showFallback:$=!0}=t?t():{};if((!O||l&&l!=="$$f")&&S)return u.resolved=!0,b&&b(),b=s=l=void 0,$e(u.effects),g();if($)return b?x:Se(be=>(b=be,s&&(N({id:s.id+"F",count:0}),s=void 0),e.fallback),c)})})}})}const X=Symbol("store-raw"),D=Symbol("store-node"),v=Symbol("store-has"),ce=Symbol("store-self");function ae(e){let n=e[j];if(!n&&(Object.defineProperty(e,j,{value:n=new Proxy(e,Te)}),!Array.isArray(e))){const t=Object.keys(e),s=Object.getOwnPropertyDescriptors(e);for(let l=0,r=t.length;l<r;l++){const o=t[l];s[o].get&&Object.defineProperty(e,o,{enumerable:s[o].enumerable,get:s[o].get.bind(n)})}}return n}function E(e){let n;return e!=null&&typeof e=="object"&&(e[j]||!(n=Object.getPrototypeOf(e))||n===Object.prototype||Array.isArray(e))}function k(e,n=new Set){let t,s,l,r;if(t=e!=null&&e[X])return t;if(!E(e)||n.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):n.add(e);for(let o=0,h=e.length;o<h;o++)l=e[o],(s=k(l,n))!==l&&(e[o]=s)}else{Object.isFrozen(e)?e=Object.assign({},e):n.add(e);const o=Object.keys(e),h=Object.getOwnPropertyDescriptors(e);for(let f=0,i=o.length;f<i;f++)r=o[f],!h[r].get&&(l=e[r],(s=k(l,n))!==l&&(e[r]=s))}return e}function H(e,n){let t=e[n];return t||Object.defineProperty(e,n,{value:t=Object.create(null)}),t}function K(e,n,t){if(e[n])return e[n];const[s,l]=z(t,{equals:!1,internal:!0});return s.$=l,e[n]=s}function _e(e,n){const t=Reflect.getOwnPropertyDescriptor(e,n);return!t||t.get||!t.configurable||n===j||n===D||(delete t.value,delete t.writable,t.get=()=>e[j][n]),t}function he(e){G()&&K(H(e,D),ce)()}function me(e){return he(e),Reflect.ownKeys(e)}const Te={get(e,n,t){if(n===X)return e;if(n===j)return t;if(n===J)return he(e),t;const s=H(e,D),l=s[n];let r=l?l():e[n];if(n===D||n===v||n==="__proto__")return r;if(!l){const o=Object.getOwnPropertyDescriptor(e,n);G()&&(typeof r!="function"||e.hasOwnProperty(n))&&!(o&&o.get)&&(r=K(s,n,r)())}return E(r)?ae(r):r},has(e,n){return n===X||n===j||n===J||n===D||n===v||n==="__proto__"?!0:(G()&&K(H(e,v),n)(),n in e)},set(){return!0},deleteProperty(){return!0},ownKeys:me,getOwnPropertyDescriptor:_e};function A(e,n,t,s=!1){if(!s&&e[n]===t)return;const l=e[n],r=e.length;t===void 0?(delete e[n],e[v]&&e[v][n]&&l!==void 0&&e[v][n].$()):(e[n]=t,e[v]&&e[v][n]&&l===void 0&&e[v][n].$());let o=H(e,D),h;if((h=K(o,n,l))&&h.$(()=>t),Array.isArray(e)&&e.length!==r){for(let f=e.length;f<r;f++)(h=o[f])&&h.$();(h=K(o,"length",r))&&h.$(e.length)}(h=o[ce])&&h.$()}function de(e,n){const t=Object.keys(n);for(let s=0;s<t.length;s+=1){const l=t[s];A(e,l,n[l])}}function Ke(e,n){if(typeof n=="function"&&(n=n(e)),n=k(n),Array.isArray(n)){if(e===n)return;let t=0,s=n.length;for(;t<s;t++){const l=n[t];e[t]!==l&&A(e,t,l)}A(e,"length",s)}else de(e,n)}function R(e,n,t=[]){let s,l=e;if(n.length>1){s=n.shift();const o=typeof s,h=Array.isArray(e);if(Array.isArray(s)){for(let f=0;f<s.length;f++)R(e,[s[f]].concat(n),t);return}else if(h&&o==="function"){for(let f=0;f<e.length;f++)s(e[f],f)&&R(e,[f].concat(n),t);return}else if(h&&o==="object"){const{from:f=0,to:i=e.length-1,by:u=1}=s;for(let c=f;c<=i;c+=u)R(e,[c].concat(n),t);return}else if(n.length>1){R(e[s],n,[s].concat(t));return}l=e[s],t=[s].concat(t)}let r=n[0];typeof r=="function"&&(r=r(l,t),r===l)||s===void 0&&r==null||(r=k(r),s===void 0||E(l)&&E(r)&&!Array.isArray(r)?de(l,r):A(e,s,r))}function Le(...[e,n]){const t=k(e||{}),s=Array.isArray(t),l=ae(t);function r(...o){Oe(()=>{s&&o.length===1?Ke(t,o[0]):R(t,o)})}return[l,r]}const Y=Symbol("store-root");function F(e,n,t,s,l){const r=n[t];if(e===r)return;const o=Array.isArray(e);if(t!==Y&&(!E(e)||!E(r)||o!==Array.isArray(r)||l&&e[l]!==r[l])){A(n,t,e);return}if(o){if(e.length&&r.length&&(!s||l&&e[0]&&e[0][l]!=null)){let i,u,c,w,b,g,x,O;for(c=0,w=Math.min(r.length,e.length);c<w&&(r[c]===e[c]||l&&r[c]&&e[c]&&r[c][l]===e[c][l]);c++)F(e[c],r,c,s,l);const S=new Array(e.length),$=new Map;for(w=r.length-1,b=e.length-1;w>=c&&b>=c&&(r[w]===e[b]||l&&r[w]&&e[b]&&r[w][l]===e[b][l]);w--,b--)S[b]=r[w];if(c>b||c>w){for(u=c;u<=b;u++)A(r,u,e[u]);for(;u<e.length;u++)A(r,u,S[u]),F(e[u],r,u,s,l);r.length>e.length&&A(r,"length",e.length);return}for(x=new Array(b+1),u=b;u>=c;u--)g=e[u],O=l&&g?g[l]:g,i=$.get(O),x[u]=i===void 0?-1:i,$.set(O,u);for(i=c;i<=w;i++)g=r[i],O=l&&g?g[l]:g,u=$.get(O),u!==void 0&&u!==-1&&(S[u]=r[i],u=x[u],$.set(O,u));for(u=c;u<e.length;u++)u in S?(A(r,u,S[u]),F(e[u],r,u,s,l)):A(r,u,e[u])}else for(let i=0,u=e.length;i<u;i++)F(e[i],r,i,s,l);r.length>e.length&&A(r,"length",e.length);return}const h=Object.keys(e);for(let i=0,u=h.length;i<u;i++)F(e[h[i]],r,h[i],s,l);const f=Object.keys(r);for(let i=0,u=f.length;i<u;i++)e[f[i]]===void 0&&A(r,f[i],void 0)}function He(e,n={}){const{merge:t,key:s="id"}=n,l=k(e);return r=>{if(!E(r)||!E(l))return l;const o=F(l,{[Y]:r},Y,t,s);return o===void 0?r:o}}export{qe as S,xe as a,Le as b,Se as c,Ie as d,Ue as e,ve as o,He as r,y as s};
